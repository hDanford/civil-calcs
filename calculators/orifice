<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Orifice Flow Calculator (Circular)</title>
<meta name="description" content="Compute flow through a circular orifice (free or submerged). US & SI.">
<link rel="stylesheet" href="../assets/styles.css">
</head><body>
<header><div class="container"><h1>Orifice — Circular (Free/Submerged)</h1><nav class="small">
  <a href="../index.html">Home</a> · <a href="../pages/methods.html">Methods</a>
</nav></div></header>
<main class="container">
  <div class="card">
    <div class="row">
      <div><label>System</label><select id="sys"><option value="US">US (ft, cfs)</option><option value="SI">SI (m, m³/s)</option></select></div>
      <div><label>Diameter, D</label><input id="D" type="number" step="0.0001" placeholder="ft or m"></div>
      <div><label>Cd</label><input id="Cd" type="number" step="0.01" placeholder="e.g., 0.62"></div>
      <div><label>Mode</label><select id="mode"><option value="free">Free outfall (head H)</option><option value="sub">Submerged (H1 - H2)</option></select></div>
    </div>
    <div class="row" id="grpFree"><div><label>Head, H</label><input id="H" type="number" step="0.0001" placeholder="ft or m"></div></div>
    <div class="row" id="grpSub" hidden>
      <div><label>Head upstream, H1</label><input id="H1" type="number" step="0.0001"></div>
      <div><label>Head downstream, H2</label><input id="H2" type="number" step="0.0001"></div>
    </div>
    <div class="row"><button id="calc">Calculate Q</button><button id="copy">Copy Excel</button></div>
    <div id="out" class="result"></div>
  </div>
  <div class="ad">Ad slot</div>
</main>
<script type="module">
  import {on,show,setResult,fmt,$,copy} from '../assets/app.js';
  import {orificeQ, excelOrifice} from '../calc/orifice.js';
  const mode=$('#mode'), grpFree=$('#grpFree'), grpSub=$('#grpSub');
  on(mode,'change', ()=>{ const m=mode.value; show(grpFree,m==='free'); show(grpSub,m==='sub'); });
  on('calc','click', ()=>{
    const sys=$('#sys').value, D=+$('#D').value, Cd=+$('#Cd').value||0.62;
    const m=mode.value;
    let Q=NaN;
    if(m==='free'){ const H=+$('#H').value; Q=orificeQ(sys,D,Cd,{mode:'free',H}); }
    else{ const H1=+$('#H1').value, H2=+$('#H2').value; Q=orificeQ(sys,D,Cd,{mode:'sub',H1,H2}); }
    setResult('out', isFinite(Q)? `Q = <b>${fmt(Q,5)} ${sys==='US'?'cfs':'m³/s'}</b>` : 'Check inputs.');
  });
  on('copy','click', ()=> copy(excelOrifice()));
</script>
</body></html>
